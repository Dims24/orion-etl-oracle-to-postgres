# YAML ‚áÑ Excel –ö–æ–Ω–≤–µ—Ä—Ç–µ—Ä –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π

–£—Ç–∏–ª–∏—Ç–∞ –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ YAML –∏–∑ Excel-—Ñ–∞–π–ª–∞ –∏ –æ–±—Ä–∞—Ç–Ω–æ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ Excel-—Ñ–∞–π–ª–∞ –∏–∑ YAML.

–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –æ–ø–∏—Å–∞–Ω–∏–µ ETL-–ø—Ä–æ—Ü–µ—Å—Å–æ–≤: —Ç–∞–±–ª–∏—Ü—ã, –º–∞–ø–ø–∏–Ω–≥–∏, —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–∏, –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–∞–Ω–Ω—ã—Ö, lookup'—ã.

---

## üì¶ –°—Ç—Ä—É–∫—Ç—É—Ä–∞

- `config/`
  - `global.yaml` ‚Äî –≥–ª–æ–±–∞–ª—å–Ω—ã–π –∫–æ–Ω—Ñ–∏–≥ —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ –∑–∞–≥—Ä—É–∑–∫–∏ –∏ —Å–ø–∏—Å–∫–æ–º —Ç–∞–±–ª–∏—Ü
  - `tables/` ‚Äî –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è —Å YAML-—Ñ–∞–π–ª–∞–º–∏ —Ç–∞–±–ª–∏—Ü (–ø–æ –æ–¥–Ω–æ–º—É –Ω–∞ –∫–∞–∂–¥—É—é —Ç–∞–±–ª–∏—Ü—É)
- `data/main.xlsx` ‚Äî –∏—Å—Ö–æ–¥–Ω—ã–π –∏–ª–∏ —Ä–µ–∑—É–ª—å—Ç–∏—Ä—É—é—â–∏–π Excel-—Ñ–∞–π–ª

---

## üöÄ –£—Å—Ç–∞–Ω–æ–≤–∫–∞

–¢—Ä–µ–±—É–µ—Ç—Å—è Python 3.7+ –∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:

```bash
pip install pandas pyyaml openpyxl
```

---

## ‚öôÔ∏è –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### ‚ñ∂Ô∏è –ì–µ–Ω–µ—Ä–∞—Ü–∏—è YAML –∏–∑ Excel

```bash
python3 script.py --xlsx_file data/main.xlsx --tables_folder tables
```

- Excel-—Ñ–∞–π–ª `data/main.xlsx` –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å:
  - –ü–µ—Ä–≤—ã–π –ª–∏—Å—Ç: –æ–ø–∏—Å–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü
  - –û—Å—Ç–∞–ª—å–Ω—ã–µ –ª–∏—Å—Ç—ã: –ø—Ä–∞–≤–∏–ª–∞ –º–∞–ø–ø–∏–Ω–≥–∞ (–µ—Å–ª–∏ –∑–∞–¥–∞–Ω—ã)

### ‚óÄÔ∏è –ì–µ–Ω–µ—Ä–∞—Ü–∏—è Excel –∏–∑ YAML

```bash
python3 script.py --reverse --xlsx_file data/generated.xlsx --tables_folder tables
```

- –°–∫—Ä–∏–ø—Ç –ø—Ä–æ—á–∏—Ç–∞–µ—Ç –∫–æ–Ω—Ñ–∏–≥–∏ –≤ `config/global.yaml` –∏ `config/tables/*.yaml`
- –°—Ñ–æ—Ä–º–∏—Ä—É–µ—Ç `data/generated.xlsx` —Å –≥–∏–ø–µ—Ä—Å—Å—ã–ª–∫–∞–º–∏ –Ω–∞ –ª–∏—Å—Ç—ã –º–∞–ø–ø–∏–Ω–≥–∞

---

## üß© –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –ø–æ–ª—è

### –í —Ç–∞–±–ª–∏—Ü–µ

| –ü–æ–ª–µ               | –û–ø–∏—Å–∞–Ω–∏–µ                           |
|--------------------|------------------------------------|
| `source_table`     | –ò—Å—Ö–æ–¥–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞                   |
| `target_table`     | –¶–µ–ª–µ–≤–∞—è —Ç–∞–±–ª–∏—Ü–∞                    |
| `source_schema`    | –°—Ö–µ–º–∞ –∏—Å—Ç–æ—á–Ω–∏–∫–∞                    |
| `target_schema`    | –°—Ö–µ–º–∞ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è (`public` –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é) |
| `fetcher_plugin`   | –ü–ª–∞–≥–∏–Ω –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è              |
| `transform_override` | –û—Ç–∫–ª—é—á–∏—Ç—å –≥–ª–æ–±–∞–ª—å–Ω—ã–µ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–∏ |
| `transform_plugins` | –°–ø–∏—Å–æ–∫ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–µ—Ä–æ–≤ —á–µ—Ä–µ–∑ `,`     |
| `loader_plugin`    | –ü–ª–∞–≥–∏–Ω –∑–∞–≥—Ä—É–∑–∫–∏                    |
| `mappings`         | –ò–º—è –ª–∏—Å—Ç–∞ —Å –ø—Ä–∞–≤–∏–ª–∞–º–∏ –º–∞–ø–ø–∏–Ω–≥–∞     |

### –í –º–∞–ø–ø–∏–Ω–≥–µ

| –ü–æ–ª–µ        | –û–ø–∏—Å–∞–Ω–∏–µ                                      |
|-------------|-----------------------------------------------|
| `source`    | –ö–æ–ª–æ–Ω–∫–∞-–∏—Å—Ç–æ—á–Ω–∏–∫                              |
| `target`    | –¶–µ–ª–µ–≤–∞—è –∫–æ–ª–æ–Ω–∫–∞                               |
| `transform` | –û–ø–∏—Å–∞–Ω–∏–µ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–π (`func1,func2`)        |
| `plugin`    | –ü–ª–∞–≥–∏–Ω –º–∞–ø–ø–∏–Ω–≥–∞                               |
| `lookup`    | Lookup-–æ–ø–∏—Å–∞–Ω–∏–µ –≤ —Ñ–æ—Ä–º–∞—Ç–µ `on_missing:table.key=value_col` |
| `validation`| –ü—Ä–æ–≤–µ—Ä–∫–∏ (`regex:...`, `range:...`, `lookup:...`) |

---

## üìù –ü—Ä–∏–º–µ—Ä –≤—ã–∑–æ–≤–∞

```bash
python3 script.py --xlsx_file data/my_config.xlsx
```

```bash
python3 script.py --reverse --xlsx_file data/exported.xlsx
```

---

## üìÇ –ü—Ä–∏–º–µ—Ä —Å—Ç—Ä—É–∫—Ç—É—Ä—ã

```
project/
‚îú‚îÄ‚îÄ config/
‚îÇ   ‚îú‚îÄ‚îÄ global.yaml
‚îÇ   ‚îî‚îÄ‚îÄ tables/
‚îÇ       ‚îú‚îÄ‚îÄ customer.yaml
‚îÇ       ‚îî‚îÄ‚îÄ orders.yaml
‚îú‚îÄ‚îÄ data/
‚îÇ   ‚îî‚îÄ‚îÄ main.xlsx
‚îú‚îÄ‚îÄ script.py
‚îî‚îÄ‚îÄ README.md
```

---

## üìë –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

–î–ª—è –≤—ã–≤–æ–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –ª–æ–≥–≥–µ—Ä (`logger.py`), –∫–æ—Ç–æ—Ä—ã–π –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ `setup_logging()`.

---

## üì¨ –û–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å

–î–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤—ã—Ö —Ç–∏–ø–æ–≤ –ø—Ä–∞–≤–∏–ª, —É–ª—É—á—à–µ–Ω–∏–π –∏–ª–∏ –≤–æ–ø—Ä–æ—Å–æ–≤ ‚Äî –æ–±—Ä–∞—â–∞–π—Å—è –Ω–∞–ø—Ä—è–º—É—é.
